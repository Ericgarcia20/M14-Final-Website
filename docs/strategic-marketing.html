<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Strategic Marketing Projects – Eric Garcia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-a885d49d3929232d915aa722be2c3edf.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Eric Garcia</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./strategic-marketing.html" aria-current="page"> 
<span class="menu-text">Marketing Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./marketing-analytics.html"> 
<span class="menu-text">Marketing Analytics</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./resume.html"> 
<span class="menu-text">Résumé</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#leveraging-artificial-intelligence-ai-through-active-listening-training" id="toc-leveraging-artificial-intelligence-ai-through-active-listening-training" class="nav-link active" data-scroll-target="#leveraging-artificial-intelligence-ai-through-active-listening-training"><strong>Leveraging Artificial Intelligence (AI) Through Active Listening Training</strong></a></li>
  <li><a href="#protein-popcorn-chatbot---group-client-research" id="toc-protein-popcorn-chatbot---group-client-research" class="nav-link" data-scroll-target="#protein-popcorn-chatbot---group-client-research">Protein Popcorn Chatbot - Group Client Research</a></li>
  <li><a href="#farm-store-retail-strategy" id="toc-farm-store-retail-strategy" class="nav-link" data-scroll-target="#farm-store-retail-strategy">Farm Store Retail Strategy</a></li>
  <li><a href="#online-coffee-retailer-on-shopify" id="toc-online-coffee-retailer-on-shopify" class="nav-link" data-scroll-target="#online-coffee-retailer-on-shopify">Online Coffee Retailer on Shopify</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Strategic Marketing Projects</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Below are selected projects that showcase my work in strategic marketing, campaign development, and brand management. These examples highlight how I apply leadership, data-informed decision making, and creative direction to drive marketing success.</p>
<section id="leveraging-artificial-intelligence-ai-through-active-listening-training" class="level2">
<h2 class="anchored" data-anchor-id="leveraging-artificial-intelligence-ai-through-active-listening-training"><strong>Leveraging Artificial Intelligence (AI) Through Active Listening Training</strong></h2>
<p>In this project, I led the development of a comprehensive AI-driven training tool to improve salesperson listening skills using GPT-based chatbots. My role centered around designing and deploying two distinct GPT chatbot models (one that accepts free-text responses and another that uses multiple-choice interactions) to simulate real-life B2B sales scenarios and evaluate salesperson behavior. I integrated prompt engineering techniques to measure key communication tactics and constructed over 1,000 survey-style prompts to gather measurable insights on listener effectiveness.</p>
<p>As part of the analytical objective, I applied a custom GPT formula across six targeted questions, 50 buyer personas, and four experimental conditions, resulting in 200 unique persona-condition combinations and generating a dataset of over 1,000 structured response points. These simulated conversations were then analyzed to identify which listening tactics (Delay = timing of response) and (Value Affirmation = emphasizing relevance of features) influenced the Purchase Decision (dependent variable).</p>
<p>The six questions, structured as Likert-scale and binary prompts (e.g., “Did the salesperson have a delay in their interaction?”), helped evaluate behaviors like timing, affirmation, and persistence during negotiations. Survey ratings were derived strictly using the customer’s persona, final response, and rationale, providing standardized data for comparison across conditions.</p>
<p>This work is part of a broader research initiative aimed at bridging the gap between subjective listening skills and objective performance in sales calls. Through careful documentation, iterative prompt refinement, and collaboration with a partner, we designed a scalable, cost-effective solution to train and evaluate salespeople using generative AI tools.</p>
<p><strong>Skills Demonstrated:</strong></p>
<ul>
<li><strong>AI Integration &amp; Prompt Engineering:</strong> Designed structured and variable prompts across complex conversational conditions to model sales interactions and behaviors.</li>
<li><strong>Data Analysis &amp; Experimental Design:</strong> Implemented controlled variables (Delay, Value Affirmation) and collected over 1,000 data points across 200 chatbot simulations.</li>
<li><strong>Marketing &amp; Training Strategy:</strong> Created a training tool rooted in real-world sales psychology to improve sales performance using LLM-based feedback.</li>
<li><strong>Collaborative Development:</strong> Worked closely with a teammate to co-develop chatbot logic, refine output, and maintain detailed project documentation.</li>
<li><strong>UX &amp; Conversational Design:</strong> Crafted free-form and multiple-choice interfaces to simulate sales conversations and deliver user-friendly training flows.</li>
</ul>
<hr>
</section>
<section id="protein-popcorn-chatbot---group-client-research" class="level2">
<h2 class="anchored" data-anchor-id="protein-popcorn-chatbot---group-client-research">Protein Popcorn Chatbot - Group Client Research</h2>
<p>In this project, I led the development of a comprehensive marketing research and strategy initiative for Up Energy’s Protein Popcorn chatbot recommendation tool. Focused on improving customer acquisition and product awareness, I spearheaded a cross-functional campaign that involved in-depth consumer research, segmentation analysis, and strategic recommendations. From identifying decision-making challenges to exploring digital marketing avenues, my team and I managed the entire lifecycle of the project, aligning our strategy with client business goals and KPIs related to consumer engagement, conversion rates, and brand positioning.</p>
<p>Our work included assessing consumer familiarity with protein popcorn, evaluating perceptions around its health benefits, and understanding how messaging, flavors, packaging, and pricing influenced buyer behavior. We also studied how demographic factors and fitness levels shaped preferences, and made targeted recommendations to help the brand reach beyond typical gym-goers to appeal to broader audiences like parents, busy professionals, and individuals with dietary restrictions.</p>
<p>Ultimately, the chatbot was envisioned as an intelligent, data-driven tool to support personalized product recommendations based on consumer profiles, thereby improving the user experience and helping the brand stand out in a competitive healthy snack market.</p>
<p><strong>Skills Demonstrated:</strong></p>
<ul>
<li><strong>Marketing Strategy:</strong> Defined business objectives around consumer engagement and product adoption. Created data-driven strategies to meet those goals, including targeted outreach and segmentation.</li>
<li><strong>Market Research:</strong> Conducted qualitative and quantitative research, including consumer interviews and sentiment analysis, to evaluate brand awareness, packaging preferences, pricing sensitivity, and dietary needs.</li>
<li><strong>Consumer Insights:</strong> Identified behavioral patterns and purchase drivers across demographics, fitness levels, and income groups to craft more inclusive marketing strategies.</li>
<li><strong>Messaging and Positioning:</strong> Developed storytelling frameworks emphasizing transparency, science-backed health claims, and real-world usability to enhance brand trust and relatability.</li>
<li><strong>Digital Marketing Tactics:</strong> Recommended high-impact digital channels such as Instagram, influencer partnerships, and sampling events to boost brand visibility and product trials.</li>
<li><strong>Cross-functional Collaboration:</strong> Worked with a diverse team to synthesize insights, brainstorm innovative solutions, and deliver a cohesive, actionable strategy to the client.</li>
</ul>
<hr>
</section>
<section id="farm-store-retail-strategy" class="level2">
<h2 class="anchored" data-anchor-id="farm-store-retail-strategy">Farm Store Retail Strategy</h2>
<p>In this project, I led the development of retail experience enhancements for the Cal Poly Pomona Farm Store, with a focus on HR optimization, customer service design, and store presentation. I contributed to the merchandising strategy through the creation of a themed gift box concept tailored to the store’s seasonal retail events, emphasizing local branding and customer engagement. My responsibilities included redesigning the store’s visual merchandising approach to address layout constraints and improve traffic flow, as well as introducing service strategies to better align with customer expectations and staffing limitations.</p>
<p>Additionally, I developed practical solutions to enhance store management, incorporating workforce planning that considers student staffing cycles and seasonal demand. By aligning store presentation with the Farm Store’s value proposition (offering fresh, locally grown products in a student-driven retail environment) I supported both the educational mission and commercial success of the store.</p>
<p><strong>Skills Demonstrated:</strong></p>
<ul>
<li><strong>Retail Strategy &amp; Merchandising:</strong> Created a thematic gift box concept aligned with seasonal promotions, improving impulse purchases and gift revenue streams.</li>
<li><strong>Visual Merchandising:</strong> Designed store layout and presentation strategies to optimize limited physical space and improve the in-store customer journey.</li>
<li><strong>Human Resource Management:</strong> Proposed staffing solutions suited for a student-operated store, addressing turnover, seasonality, and scheduling challenges.</li>
<li><strong>Customer Experience Design:</strong> Enhanced service models to reduce crowding frustrations, incorporating clearer signage, better queue management, and convenience-focused adjustments.</li>
<li><strong>Brand Development:</strong> Integrated farm-to-table identity and Cal Poly branding into packaging and presentation to differentiate the Farm Store from commercial competitors.</li>
</ul>
<hr>
</section>
<section id="online-coffee-retailer-on-shopify" class="level2">
<h2 class="anchored" data-anchor-id="online-coffee-retailer-on-shopify">Online Coffee Retailer on Shopify</h2>
<p>In this project, I led the development of a complete business plan for iluvcafecito, an e-commerce coffee brand under TJE Holdings, LLC. I was responsible for shaping the concept, building the brand identity, and creating a comprehensive strategy covering operations, marketing, product offerings, and financial forecasting. From identifying the target market to crafting the brand’s mission and visual style, I directed all aspects of the business launch plan with an emphasis on sustainability, ethical sourcing, and customer-centric innovation.</p>
<p>The plan included a multi-phase rollout starting with online sales of premium coffee products (beans, grounds, accessories, and subscriptions) followed by pop-up presence at local farmers markets, and ultimately the establishment of a physical retail location. I designed the customer experience strategy around convenience and customization through tailored subscription models, while building in retention tactics like loyalty programs and seasonal product drops.</p>
<p><strong>Skills Demonstrated:</strong></p>
<ul>
<li><strong>Business Strategy &amp; Planning:</strong> Developed a scalable business model with phased growth from e-commerce to brick-and-mortar, with defined milestones and financial projections.</li>
<li><strong>Brand Development:</strong> Created a unique brand identity that emphasizes ethical sourcing, sustainability, and premium quality, with cohesive branding across packaging, digital presence, and marketing.</li>
<li><strong>Marketing Strategy:</strong> Outlined a full-funnel marketing approach including SEO, content marketing, social media campaigns, influencer partnerships, and paid advertising to drive traffic and conversion.</li>
<li><strong>E-Commerce Development:</strong> Designed the e-commerce platform architecture (Shopify), including payment integration, product organization, and subscription customization.</li>
<li><strong>Operations Management:</strong> Established supplier relationships (e.g., Temecula Coffee Roasters), fulfillment plans, customer service protocols, and technology stack including CRM and email automation tools.</li>
<li><strong>Financial Forecasting:</strong> Built realistic financial models projecting revenue growth, break-even timelines, and funding requirements, with a focus on recurring subscription income and high-margin upsells.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ericgarcia20\.quarto\.pub\/eric-garcia-portfolio");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>